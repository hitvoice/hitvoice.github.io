<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- common.css -->
  <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: Arial, Helvetica, sans-serif;margin: 0;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre {margin: 0;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
  <!-- ace-static.css -->
  <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
  <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
  <!-- export.css -->
  <style>
    body{margin:0 auto;max-width:800px;line-height:1.4}
    #nav{margin:5px 0 10px;font-size:15px}
    #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
    #contentarea{font-size:15px;margin:16px 0}
    .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
    .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
    .latex-cell{white-space:pre-wrap;}
  </style>
  <!-- User CSS -->
  <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
</head>
<body>
  <div id="nav"><div>Next: <a href='Cross Entropy.html'>Cross Entropy</a>, Previous: <a href='Conjugate Prior.html'>Conjugate Prior</a>, Up: <a href='index.html'>Index</a></div></div>
  <div id="titlearea">
    <h2>Convolutional Neural Network</h2>
  </div>
  <div id="contentarea"><div class="cell markdown-cell"><h3 id="motivation-of-convolution">Motivation of convolution</h3>
<p>Fully connected networks are computationally expensive when the number of input units is large. Locally connected networks, in which each hidden unit will connect to only a small contiguous region of pixels in the input, are feasible for high resolution images.<br>Natural images have the property of being ”stationary”, meaning that the statistics of one part of the image are the same as any other part. This suggests that the features that we learn at one part of the image can also be applied to other parts of the image, and we can use the same features at all locations.</p>
<h3 id="convolution">Convolution</h3>
<p>Formally, given some large <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-312-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7833" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.031em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.815em, 1000em, 2.681em, -0.424em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7834"><span class="mi" id="MathJax-Span-7835" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-7836" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-7837" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-312">r \times c</script> images <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-313-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7838" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.538em, 1000em, 2.587em, -0.496em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7839"><span class="msubsup" id="MathJax-Span-7840"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7841" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="texatom" id="MathJax-Span-7842"><span class="mrow" id="MathJax-Span-7843"><span class="mi" id="MathJax-Span-7844" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-7845" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-7846" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mi" id="MathJax-Span-7847" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-7848" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.009em; vertical-align: -0.417em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">x_{large}</script>, we first train a sparse autoencoder on small <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7849" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.681em, -0.452em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7850"><span class="mi" id="MathJax-Span-7851" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7852" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-7853" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.975em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">a \times b</script> patches <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7854" style="width: 2.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.188em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.538em, 1000em, 2.451em, -0.496em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7855"><span class="msubsup" id="MathJax-Span-7856"><span style="display: inline-block; position: relative; width: 2.155em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7857" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="texatom" id="MathJax-Span-7858"><span class="mrow" id="MathJax-Span-7859"><span class="mi" id="MathJax-Span-7860" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-7861" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-7862" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-7863" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-7864" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.845em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">x_{small}</script> sampled from these images, learning <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-316-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7865" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.667em, -0.455em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7866"><span class="mi" id="MathJax-Span-7867" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.958em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-316">k</script> features <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-317-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7868" style="width: 11.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.74em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.456em, 1000em, 2.863em, -0.616em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7869"><span class="mi" id="MathJax-Span-7870" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-7871" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7872" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-7873" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7874"><span style="display: inline-block; position: relative; width: 1.97em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.674em, -0.398em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7875" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.567em; left: 1.009em;"><span class="texatom" id="MathJax-Span-7876"><span class="mrow" id="MathJax-Span-7877"><span class="mo" id="MathJax-Span-7878" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7879" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7880" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7881"><span style="display: inline-block; position: relative; width: 2.155em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7882" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="texatom" id="MathJax-Span-7883"><span class="mrow" id="MathJax-Span-7884"><span class="mi" id="MathJax-Span-7885" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-7886" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-7887" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-7888" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-7889" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-7890" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7891" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.481em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.667em, -0.446em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7892" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.597em; left: 0.521em;"><span class="texatom" id="MathJax-Span-7893"><span class="mrow" id="MathJax-Span-7894"><span class="mo" id="MathJax-Span-7895" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7896" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7897" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-7898" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.439em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-317">f = \sigma(W^{(1)}x_{small} + b^{(1)})</script> (where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-318-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7899" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7900"><span class="mi" id="MathJax-Span-7901" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.652em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-318">\sigma</script> is the sigmoid function), given by the weights <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-319-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7902" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.121em, 1000em, 2.31em, -0.398em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7903"><span class="msubsup" id="MathJax-Span-7904"><span style="display: inline-block; position: relative; width: 1.97em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.674em, -0.398em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7905" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.567em; left: 1.009em;"><span class="texatom" id="MathJax-Span-7906"><span class="mrow" id="MathJax-Span-7907"><span class="mo" id="MathJax-Span-7908" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7909" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7910" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.176em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-319">W^{(1)}</script> and biases <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-320-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7911" style="width: 1.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.51em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.091em, 1000em, 2.303em, -0.446em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7912"><span class="msubsup" id="MathJax-Span-7913"><span style="display: inline-block; position: relative; width: 1.481em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.667em, -0.446em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7914" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.597em; left: 0.521em;"><span class="texatom" id="MathJax-Span-7915"><span class="mrow" id="MathJax-Span-7916"><span class="mo" id="MathJax-Span-7917" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7918" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7919" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.204em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-320">b^{(1)}</script> from the visible units to the hidden units. For every <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7849" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.681em, -0.452em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7850"><span class="mi" id="MathJax-Span-7851" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7852" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-7853" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.975em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">a \times b</script> patch <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-321-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7920" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.538em, 1000em, 2.451em, -0.496em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7921"><span class="msubsup" id="MathJax-Span-7922"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7923" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mi" id="MathJax-Span-7924" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.845em; vertical-align: -0.254em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-321">x_s</script> in the large image, we compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-322-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7925" style="width: 10.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.456em, 1000em, 2.908em, -0.616em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7926"><span class="msubsup" id="MathJax-Span-7927"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.863em, -0.616em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7928" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.323em;"><span class="mi" id="MathJax-Span-7929" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-7930" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7931" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-7932" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7933"><span style="display: inline-block; position: relative; width: 1.97em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.674em, -0.398em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7934" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.567em; left: 1.009em;"><span class="texatom" id="MathJax-Span-7935"><span class="mrow" id="MathJax-Span-7936"><span class="mo" id="MathJax-Span-7937" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7938" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7939" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7940"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7941" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mi" id="MathJax-Span-7942" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-7943" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7944" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.481em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.667em, -0.446em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7945" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.597em; left: 0.521em;"><span class="texatom" id="MathJax-Span-7946"><span class="mrow" id="MathJax-Span-7947"><span class="mo" id="MathJax-Span-7948" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7949" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7950" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-7951" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.492em; vertical-align: -0.364em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-322">f_s = \sigma(W^{(1)}x_s + b^{(1)})</script>, giving us <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-323-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7952" style="width: 4.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.438em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.301em, 1000em, 2.547em, -0.616em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7953"><span class="msubsup" id="MathJax-Span-7954"><span style="display: inline-block; position: relative; width: 3.419em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.863em, -0.616em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-7955" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.323em;"><span class="texatom" id="MathJax-Span-7956"><span class="mrow" id="MathJax-Span-7957"><span class="mi" id="MathJax-Span-7958" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-7959" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-7960" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-7961" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-7962" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-7963" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-7964" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-7965" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-7966" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.245em; vertical-align: -0.369em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-323">f_{convolved}</script>, a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-324-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7967" style="width: 13.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.615em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.833em, -0.455em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7968"><span class="mi" id="MathJax-Span-7969" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-7970" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mo" id="MathJax-Span-7971" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mi" id="MathJax-Span-7972" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-7973" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7974" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">a</span><span class="mo" id="MathJax-Span-7975" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-7976" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-7977" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7978" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mo" id="MathJax-Span-7979" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mi" id="MathJax-Span-7980" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-7981" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7982" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-7983" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-7984" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-7985" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.157em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-324">k \times (r - a + 1) \times (c - b + 1)</script> array of convolved features.<br><img src="resources/6428CF505AC1E9E1CF462E1EC8FE9A68.gif" alt="Convolution_schematic.gif"></p>
<h3 id="motivation-of-pooling">Motivation of pooling</h3>
<ul>
<li>Features obtained by convolution is still computationally challenging</li><li>Aggregating statistics of features at various locations is a natural way to describe a large image</li><li>Pooled features are "translation invariant", which means the same pooled feature will be active even when the image undergoes (small) translations.</li></ul>
<h3 id="pooling">Pooling</h3>
<p>After obtaining our convolved features as described earlier, we decide the size of the region, say <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-325-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7986" style="width: 2.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.344em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.815em, 1000em, 2.681em, -0.457em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7987"><span class="mi" id="MathJax-Span-7988" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-7989" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-7990" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-325">m\times n</script> to pool our convolved features over. Then, we divide our convolved features into disjoint <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-325-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7986" style="width: 2.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.344em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.815em, 1000em, 2.681em, -0.457em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7987"><span class="mi" id="MathJax-Span-7988" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-7989" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-7990" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-325">m\times n</script> regions, and take the mean (or maximum) feature activation over these regions to obtain the pooled convolved features. These pooled features can then be used for classification.<br><img src="resources/15E89EC6A866BE1F7130655527079786.gif" alt="Pooling_schematic.gif"></p>
<h3 id="architecture">Architecture</h3>
<p>A CNN consists of a number of convolutional and subsampling layers optionally followed by fully connected layers. The architecture of a CNN is designed to take advantage of the 2D structure of an input image (or other 2D input such as a speech signal). This is achieved with local connections and tied weights followed by some form of pooling which results in translation invariant features.</p>
<h3 id="back-propagation">Back Propagation</h3>
<p><strong>propagate error through a pooling layer</strong><br>The weight <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-326-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7991" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.674em, -0.398em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-7992"><span class="mi" id="MathJax-Span-7993" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.93em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-326">W</script> is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-327-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7994" style="width: 1.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.094em, 1000em, 2.643em, -0.469em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-7995"><span class="mfrac" id="MathJax-Span-7996"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.553em, 1000em, 2.344em, -0.39em); top: -2.595em; left: 50%; margin-left: -0.182em;"><span class="mn" id="MathJax-Span-7997" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.719em, 1000em, 2.35em, -0.46em); top: -1.843em; left: 50%; margin-left: -0.469em;"><span class="mrow" id="MathJax-Span-7998"><span class="mi" id="MathJax-Span-7999" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-8000" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000em, 1.198em, -0.469em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.058em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.609em; vertical-align: -0.484em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-327">\frac{1}{mn}</script> in mean pooling and 1 for the maximun, 0 for others in max pooling. The bias is 0.<br><strong>update weights in a convolutional layer</strong><br>convolve the iuput of the convolutional layer with the incoming error.</p>
<h3 id="reference">reference</h3>
<p><a href="http://deeplearning.stanford.edu/tutorial/">http://deeplearning.stanford.edu/tutorial/</a></p>
</div></div>
  <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = 'Cross Entropy.html';
if (e.keyCode === 37) window.location.href = 'Conjugate Prior.html';
}</script>
</body>
</html>