<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- common.css -->
  <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: Arial, Helvetica, sans-serif;margin: 0;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre {margin: 0;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
  <!-- ace-static.css -->
  <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
  <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
  <!-- export.css -->
  <style>
    body{margin:0 auto;max-width:800px;line-height:1.4}
    #nav{margin:5px 0 10px;font-size:15px}
    #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
    #contentarea{font-size:15px;margin:16px 0}
    .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
    .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
    .latex-cell{white-space:pre-wrap;}
  </style>
  <!-- User CSS -->
  <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
</head>
<body>
  <div id="nav"><div>Next: <a href='Metropolis-Hastings Algorithm.html'>Metropolis-Hastings Algorithm</a>, Previous: <a href='KL Divergence.html'>KL Divergence</a>, Up: <a href='index.html'>Index</a></div></div>
  <div id="titlearea">
    <h2>Latent Dirichlet Allocation</h2>
  </div>
  <div id="contentarea"><div class="cell markdown-cell"><h2 id="motivation">Motivation</h2>
<ul>
<li>Add a conjugate prior to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-105-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2265" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2266"><span class="mi" id="MathJax-Span-2267" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.952em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\theta</script> in pLSA, reduce the number of parameters from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-106-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2268" style="width: 5.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.697em, -0.487em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2269"><span class="mi" id="MathJax-Span-2270" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-2271" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-2272" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-2273" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mi" id="MathJax-Span-2274" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.958em; vertical-align: -0.112em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">MK+KV</script> to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-107-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2275" style="width: 4.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.333em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.697em, -0.462em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2276"><span class="mi" id="MathJax-Span-2277" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-2278" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-2279" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mi" id="MathJax-Span-2280" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.958em; vertical-align: -0.112em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">K+KV</script>, which is independent from the number of documents and makes the model less prone to overfitting. </li><li>Besides the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\beta</script> matrix, in pLSA, we learn M points; but in LDA, we learn a dirichlet. So we can easily generalize the trained model to unseen documents.</li></ul>
<h2 id="specification">Specification</h2>
<p>original version:</p>
<div align="center"><br><img src="resources/F4E0ABBDCDA25D7ED8B170AE9636D1F0.png" width="30%" height="30%"><br></div><br>smoothed version:<br><div align="center"><br><img src="resources/5531DDF2707F3C1B03B5DDA177CEF26E.png" width="30%" height="30%"><br></div>

<p>Parameters for original version:</p>
<ul>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2284" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.462em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2285"><span class="mi" id="MathJax-Span-2286" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">K</script>: number of topics</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-110-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2287" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.487em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2288"><span class="mi" id="MathJax-Span-2289" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">M</script>: number of documents</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-111-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2290" style="width: 1.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.326em, 1000em, 2.448em, -0.489em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-2291"><span class="msubsup" id="MathJax-Span-2292"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.671em, -0.489em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2293" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.669em;"><span class="mi" id="MathJax-Span-2294" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.096em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">N_m</script>: length of m-th document</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-112-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2295" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.674em, -0.393em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2296"><span class="mi" id="MathJax-Span-2297" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.93em; vertical-align: -0.084em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">V</script>: size of vocabulary</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2298" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2299"><span class="mi" id="MathJax-Span-2300" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.667em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\alpha</script>: Dirichlet prior</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\beta</script>: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-114-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2301" style="width: 3.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.552em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.681em, -0.462em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2302"><span class="mi" id="MathJax-Span-2303" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-2304" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-2305" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.939em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">K\times V</script>, word distribution of topics</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-105-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2265" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2266"><span class="mi" id="MathJax-Span-2267" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.952em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\theta</script>: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-115-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2306" style="width: 3.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.681em, -0.487em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2307"><span class="mi" id="MathJax-Span-2308" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-2309" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">×</span><span class="mi" id="MathJax-Span-2310" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.939em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">M\times K</script>, topic distribution of documents</li></ul>
<p>Parameters for smoothed version:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-116-Frame" style=""><nobr><span class="math" id="MathJax-Span-2311" style="width: 40.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 34.115em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-2.546em, 1000em, 6.316em, -0.381em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-2312"><span class="texatom" id="MathJax-Span-2313"><span class="mrow" id="MathJax-Span-2314"><span class="mtable" id="MathJax-Span-2315" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 33.731em; height: 0px;"><span style="position: absolute; clip: rect(4.772em, 1000em, 13.205em, -0.548em); top: -9.115em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.377em; height: 0px;"><span style="position: absolute; clip: rect(1.882em, 1000em, 2.669em, -0.472em); top: -6.225em; left: 0em;"><span class="mtd" id="MathJax-Span-2316"><span class="mrow" id="MathJax-Span-2317"><span class="texatom" id="MathJax-Span-2318"><span class="mrow" id="MathJax-Span-2319"><span class="mi" id="MathJax-Span-2320" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.646em, 1000em, 2.861em, -0.548em); top: -4.757em; left: 0em;"><span class="mtd" id="MathJax-Span-2329"><span class="mrow" id="MathJax-Span-2330"><span class="texatom" id="MathJax-Span-2331"><span class="mrow" id="MathJax-Span-2332"><span class="mi" id="MathJax-Span-2333" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">β</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(3.156em, 1000em, 4.326em, -0.472em); top: -4.799em; left: 0em;"><span class="mtd" id="MathJax-Span-2342"><span class="mrow" id="MathJax-Span-2343"><span class="msubsup" id="MathJax-Span-2344"><span style="display: inline-block; position: relative; width: 3.2em; height: 0px;"><span style="position: absolute; clip: rect(1.646em, 1000em, 2.669em, -0.472em); top: -2.5em; left: 0em;"><span class="texatom" id="MathJax-Span-2345"><span class="mrow" id="MathJax-Span-2346"><span class="mi" id="MathJax-Span-2347" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.521em;"><span class="texatom" id="MathJax-Span-2348"><span class="mrow" id="MathJax-Span-2349"><span class="texatom" id="MathJax-Span-2350"><span class="mrow" id="MathJax-Span-2351"><span class="mi" id="MathJax-Span-2352" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-2353" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2355" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mi" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.155em, 1000em, 4.415em, -0.472em); top: -3.349em; left: 0em;"><span class="mtd" id="MathJax-Span-2373"><span class="mrow" id="MathJax-Span-2374"><span class="msubsup" id="MathJax-Span-2375"><span style="display: inline-block; position: relative; width: 3.2em; height: 0px;"><span style="position: absolute; clip: rect(1.645em, 1000em, 2.861em, -0.472em); top: -2.5em; left: 0em;"><span class="texatom" id="MathJax-Span-2376"><span class="mrow" id="MathJax-Span-2377"><span class="mi" id="MathJax-Span-2378" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.677em;"><span class="texatom" id="MathJax-Span-2379"><span class="mrow" id="MathJax-Span-2380"><span class="texatom" id="MathJax-Span-2381"><span class="mrow" id="MathJax-Span-2382"><span class="mi" id="MathJax-Span-2383" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-2384" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2385" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2386" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mi" id="MathJax-Span-2387" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.426em, 1000em, 4.429em, -0.471em); top: -1.851em; left: 0em;"><span class="mtd" id="MathJax-Span-2404"><span class="mrow" id="MathJax-Span-2405"><span class="msubsup" id="MathJax-Span-2406"><span style="display: inline-block; position: relative; width: 6.117em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2407" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="texatom" id="MathJax-Span-2408"><span class="mrow" id="MathJax-Span-2409"><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mi" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-2413" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2414" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2415" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mi" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2418" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2419" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2420" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2421" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="msubsup" id="MathJax-Span-2422"><span style="display: inline-block; position: relative; width: 0.844em; height: 0px;"><span style="position: absolute; clip: rect(1.57em, 1000em, 2.354em, -0.483em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-2423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.478em;"><span class="texatom" id="MathJax-Span-2424"><span class="mrow" id="MathJax-Span-2425"><span class="mi" id="MathJax-Span-2426" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.413em, 1000em, 4.429em, -0.454em); top: -0.339em; left: 0em;"><span class="mtd" id="MathJax-Span-2447"><span class="mrow" id="MathJax-Span-2448"><span class="msubsup" id="MathJax-Span-2449"><span style="display: inline-block; position: relative; width: 6.377em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.674em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2450" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.677em;"><span class="texatom" id="MathJax-Span-2451"><span class="mrow" id="MathJax-Span-2452"><span class="texatom" id="MathJax-Span-2453"><span class="mrow" id="MathJax-Span-2454"><span class="mi" id="MathJax-Span-2455" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-2456" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2457" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2458" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mi" id="MathJax-Span-2459" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2460" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2461" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2462" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2463" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="msubsup" id="MathJax-Span-2465"><span style="display: inline-block; position: relative; width: 0.844em; height: 0px;"><span style="position: absolute; clip: rect(1.57em, 1000em, 2.354em, -0.483em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-2466" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.478em;"><span class="texatom" id="MathJax-Span-2467"><span class="mrow" id="MathJax-Span-2468"><span class="mi" id="MathJax-Span-2469" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.115em;"></span></span><span style="position: absolute; clip: rect(4.351em, 1000em, 12.274em, -0.421em); top: -8.594em; left: 7.502em;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px;"><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: -6.225em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2321"><span class="mrow" id="MathJax-Span-2322"><span class="mo" id="MathJax-Span-2323" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: -4.757em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2334"><span class="mrow" id="MathJax-Span-2335"><span class="mo" id="MathJax-Span-2336" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: -3.289em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2357"><span class="mrow" id="MathJax-Span-2358"><span class="mo" id="MathJax-Span-2359" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: -1.839em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2388"><span class="mrow" id="MathJax-Span-2389"><span class="mo" id="MathJax-Span-2390" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: -0.341em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2427"><span class="mrow" id="MathJax-Span-2428"><span class="mo" id="MathJax-Span-2429" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.508em, -0.421em); top: 1.172em; left: 50%; margin-left: -0.365em;"><span class="mtd" id="MathJax-Span-2470"><span class="mrow" id="MathJax-Span-2471"><span class="mo" id="MathJax-Span-2472" style="font-family: STIXGeneral-Regular;">∼</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.594em;"></span></span><span style="position: absolute; clip: rect(4.863em, 1000em, 13.608em, -0.469em); top: -9.427em; left: 9.356em;"><span style="display: inline-block; position: relative; width: 24.375em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.469em); top: -6.225em; left: 0em;"><span class="mtd" id="MathJax-Span-2324"><span class="mrow" id="MathJax-Span-2325"><span class="texatom" id="MathJax-Span-2326"><span class="mrow" id="MathJax-Span-2327"><span class="mtext" id="MathJax-Span-2328" style="font-family: STIXGeneral-Regular;">A Dirichlet hyperprior, either a constant or a random variable</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.469em); top: -4.757em; left: 0em;"><span class="mtd" id="MathJax-Span-2337"><span class="mrow" id="MathJax-Span-2338"><span class="texatom" id="MathJax-Span-2339"><span class="mrow" id="MathJax-Span-2340"><span class="mtext" id="MathJax-Span-2341" style="font-family: STIXGeneral-Regular;">A Dirichlet hyperprior, either a constant or a random variable</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.661em, 1000em, 2.833em, -0.453em); top: -3.289em; left: 0em;"><span class="mtd" id="MathJax-Span-2360"><span class="mrow" id="MathJax-Span-2361"><span class="msubsup" id="MathJax-Span-2362"><span style="display: inline-block; position: relative; width: 4.138em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.666em, -0.453em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2363" style="font-family: STIXGeneral-Regular;">Dirichlet</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 3.542em;"><span class="texatom" id="MathJax-Span-2364"><span class="mrow" id="MathJax-Span-2365"><span class="mi" id="MathJax-Span-2366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2367"></span><span class="mo" id="MathJax-Span-2368" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2369"><span class="mrow" id="MathJax-Span-2370"><span class="mi" id="MathJax-Span-2371" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span></span></span><span class="mo" id="MathJax-Span-2372" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.646em, 1000em, 2.861em, -0.453em); top: -1.839em; left: 0em;"><span class="mtd" id="MathJax-Span-2391"><span class="mrow" id="MathJax-Span-2392"><span class="msubsup" id="MathJax-Span-2393"><span style="display: inline-block; position: relative; width: 4.138em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.666em, -0.453em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2394" style="font-family: STIXGeneral-Regular;">Dirichlet</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 3.542em;"><span class="texatom" id="MathJax-Span-2395"><span class="mrow" id="MathJax-Span-2396"><span class="mi" id="MathJax-Span-2397" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2398"></span><span class="mo" id="MathJax-Span-2399" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2400"><span class="mrow" id="MathJax-Span-2401"><span class="mi" id="MathJax-Span-2402" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">β</span></span></span><span class="mo" id="MathJax-Span-2403" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.646em, 1000em, 2.91em, -0.441em); top: -0.341em; left: 0em;"><span class="mtd" id="MathJax-Span-2430"><span class="mrow" id="MathJax-Span-2431"><span class="msubsup" id="MathJax-Span-2432"><span style="display: inline-block; position: relative; width: 5.179em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.441em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2433" style="font-family: STIXGeneral-Regular;">Categorical</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.934em; left: 4.583em;"><span class="texatom" id="MathJax-Span-2434"><span class="mrow" id="MathJax-Span-2435"><span class="mi" id="MathJax-Span-2436" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2437"></span><span class="mo" id="MathJax-Span-2438" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2439"><span style="display: inline-block; position: relative; width: 1.013em; height: 0px;"><span style="position: absolute; clip: rect(1.646em, 1000em, 2.669em, -0.472em); top: -2.5em; left: 0em;"><span class="texatom" id="MathJax-Span-2440"><span class="mrow" id="MathJax-Span-2441"><span class="mi" id="MathJax-Span-2442" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.521em;"><span class="texatom" id="MathJax-Span-2443"><span class="mrow" id="MathJax-Span-2444"><span class="mi" id="MathJax-Span-2445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2446" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.645em, 1000em, 3.009em, -0.441em); top: 1.172em; left: 0em;"><span class="mtd" id="MathJax-Span-2473"><span class="mrow" id="MathJax-Span-2474"><span class="msubsup" id="MathJax-Span-2475"><span style="display: inline-block; position: relative; width: 5.179em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.441em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2476" style="font-family: STIXGeneral-Regular;">Categorical</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.934em; left: 4.583em;"><span class="texatom" id="MathJax-Span-2477"><span class="mrow" id="MathJax-Span-2478"><span class="mi" id="MathJax-Span-2479" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2480"></span><span class="mo" id="MathJax-Span-2481" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2482"><span style="display: inline-block; position: relative; width: 1.691em; height: 0px;"><span style="position: absolute; clip: rect(1.645em, 1000em, 2.861em, -0.472em); top: -2.5em; left: 0em;"><span class="texatom" id="MathJax-Span-2483"><span class="mrow" id="MathJax-Span-2484"><span class="mi" id="MathJax-Span-2485" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -3.77em; left: 0.677em;"><span class="texatom" id="MathJax-Span-2486"><span class="mrow" id="MathJax-Span-2487"><span class="texatom" id="MathJax-Span-2488"><span class="mrow" id="MathJax-Span-2489"><span class="msubsup" id="MathJax-Span-2490"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.729em, 1000em, 2.401em, -0.47em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-2491" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2492"><span class="mrow" id="MathJax-Span-2493"><span class="texatom" id="MathJax-Span-2494"><span class="mrow" id="MathJax-Span-2495"><span class="mi" id="MathJax-Span-2496" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mi" id="MathJax-Span-2497" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2498" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.427em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 10.385em; vertical-align: -4.892em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-116">
{\begin{array}{lcl}{\boldsymbol  \alpha }&\sim &{\text{A Dirichlet hyperprior, either a constant or a random variable}}\\{\boldsymbol  \beta }&\sim &{\text{A Dirichlet hyperprior, either a constant or a random variable}}\\{\boldsymbol  \theta }_{{d=1\dots M}}&\sim &\operatorname {Dirichlet}_{K}({\boldsymbol  \alpha })\\{\boldsymbol  \phi }_{{k=1\dots K}}&\sim &\operatorname {Dirichlet}_{V}({\boldsymbol  \beta })\\z_{{d=1\dots M,n=1\dots N_{d}}}&\sim &\operatorname {Categorical}_{K}({\boldsymbol  \theta }_{d})\\w_{{d=1\dots M,n=1\dots N_{d}}}&\sim &\operatorname {Categorical}_{V}({\boldsymbol  \phi }_{{z_{{dn}}}})\\\end{array}}
</script><p></p>
<p>In the orginal version,<br>Joint distribution:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-117-Frame" style=""><nobr><span class="math" id="MathJax-Span-2499" style="width: 21.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.656em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.582em, 1000em, 3.913em, -0.544em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2500"><span class="mi" id="MathJax-Span-2501" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2502" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2503" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2504" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2505" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2506" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2507" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="texatom" id="MathJax-Span-2508"><span class="mrow" id="MathJax-Span-2509"><span class="mo" id="MathJax-Span-2510" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2511" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2512" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2513" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2514" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2515" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2516" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-2517" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2518" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="texatom" id="MathJax-Span-2519"><span class="mrow" id="MathJax-Span-2520"><span class="mo" id="MathJax-Span-2521" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2522" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2523" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2524" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.419em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-2525" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∏</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.45em, -0.459em); top: -1.037em; left: 0.052em;"><span class="texatom" id="MathJax-Span-2526"><span class="mrow" id="MathJax-Span-2527"><span class="mi" id="MathJax-Span-2528" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2529" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2530" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.354em, -0.483em); top: -3.388em; left: 0.417em;"><span class="mi" id="MathJax-Span-2531" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-2532" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2533" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2534"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2535" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="mi" id="MathJax-Span-2536" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2537"><span class="mrow" id="MathJax-Span-2538"><span class="mo" id="MathJax-Span-2539" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2540" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2541" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-2542" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2543" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2544"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.674em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2545" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.677em;"><span class="mi" id="MathJax-Span-2546" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2547"><span class="mrow" id="MathJax-Span-2548"><span class="mo" id="MathJax-Span-2549" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2550"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2551" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="mi" id="MathJax-Span-2552" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2553" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2554" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2555" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.748em; vertical-align: -1.571em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-117">
p(\theta,z,w|\alpha,\beta)=p(\theta|\alpha)\prod_{n=1}^N p(z_n|\theta)p(w_n|z_n,\beta)
</script><br>The marginal distribution of a document:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-118-Frame" style=""><nobr><span class="math" id="MathJax-Span-2556" style="width: 24.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.677em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.723em, 1000em, 6.256em, -0.544em); top: -4.74em; left: 0em;"><span class="mrow" id="MathJax-Span-2557"><span class="mi" id="MathJax-Span-2558" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2559" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2560" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-2561"><span class="mrow" id="MathJax-Span-2562"><span class="mo" id="MathJax-Span-2563" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2564" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2565" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2566" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2567" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2568" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-2569" style="font-family: STIXIntegralsD; vertical-align: -0.615em; padding-left: 0.313em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.45em;"></span></span><span class="mi" id="MathJax-Span-2570" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2571" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2572" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="texatom" id="MathJax-Span-2573"><span class="mrow" id="MathJax-Span-2574"><span class="mo" id="MathJax-Span-2575" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2576" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2577" style="font-family: STIXGeneral-Regular;">)</span><span class="mrow" id="MathJax-Span-2578" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2579" style="vertical-align: 1.861em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.089em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.57em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.83em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2580"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.419em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-2581" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∏</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.45em, -0.459em); top: -1.037em; left: 0.052em;"><span class="texatom" id="MathJax-Span-2582"><span class="mrow" id="MathJax-Span-2583"><span class="mi" id="MathJax-Span-2584" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2585" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.354em, -0.483em); top: -3.388em; left: 0.417em;"><span class="mi" id="MathJax-Span-2587" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2588" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-2589" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(3.552em, 1000em, 4.377em, -0.47em); top: -2.86em; left: 0.338em;"><span class="texatom" id="MathJax-Span-2590"><span class="mrow" id="MathJax-Span-2591"><span class="msubsup" id="MathJax-Span-2592"><span style="display: inline-block; position: relative; width: 0.626em; height: 0px;"><span style="position: absolute; clip: rect(1.729em, 1000em, 2.401em, -0.47em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-2593" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.313em;"><span class="mi" id="MathJax-Span-2594" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2595" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2596" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2597"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2598" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="mi" id="MathJax-Span-2599" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2600"><span class="mrow" id="MathJax-Span-2601"><span class="mo" id="MathJax-Span-2602" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2603" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2604" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-2605" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2606" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2607"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.674em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2608" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.677em;"><span class="mi" id="MathJax-Span-2609" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2610"><span class="mrow" id="MathJax-Span-2611"><span class="mo" id="MathJax-Span-2612" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2613"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2614" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="mi" id="MathJax-Span-2615" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2616" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2617" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2618" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2619" style="vertical-align: 1.861em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.089em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.57em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.83em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="texatom" id="MathJax-Span-2620" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2621"><span class="mi" id="MathJax-Span-2622" style="font-family: STIXGeneral-Regular;">d</span></span></span><span class="mi" id="MathJax-Span-2623" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.74em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.99em; vertical-align: -1.695em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-118">
p(w|\alpha,\beta)=\int p(\theta|\alpha)
\left(
\prod_{n=1}^N\sum_{z_n}p(z_n|\theta)p(w_n|z_n,\beta
)\right)
\mathrm{d}\theta
</script><br>Posterior distribution of hidden variables:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-119-Frame" style=""><nobr><span class="math" id="MathJax-Span-2624" style="width: 14.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.188em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.989em, 1000em, 3.547em, -0.544em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2625"><span class="mi" id="MathJax-Span-2626" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2627" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2628" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2629" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2630" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="texatom" id="MathJax-Span-2631"><span class="mrow" id="MathJax-Span-2632"><span class="mo" id="MathJax-Span-2633" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2634" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-2635" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2636" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2637" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2638" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2639" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2640" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-2641" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 5.38em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.544em); top: -3.177em; left: 50%; margin-left: -2.63em;"><span class="mrow" id="MathJax-Span-2642"><span class="mi" id="MathJax-Span-2643" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2644" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2645" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2646" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2647" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2648" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2649" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="texatom" id="MathJax-Span-2650"><span class="mrow" id="MathJax-Span-2651"><span class="mo" id="MathJax-Span-2652" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2653" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2654" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2655" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2656" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.544em); top: -1.814em; left: 50%; margin-left: -1.771em;"><span class="mrow" id="MathJax-Span-2657"><span class="mi" id="MathJax-Span-2658" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2659" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2660" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-2661"><span class="mrow" id="MathJax-Span-2662"><span class="mo" id="MathJax-Span-2663" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2664" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2665" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2666" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2667" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000em, 1.198em, -0.469em); top: -1.262em; left: 0em;"><span style="border-left-width: 5.38em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.82em; vertical-align: -1.132em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-119">p(\theta,z|w,\alpha,\beta)=\frac{p(\theta,z,w|\alpha,\beta)}{p(w|\alpha,\beta)}</script><br>This posterior is intractable to compute, due to the coupling between <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-105-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2265" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2266"><span class="mi" id="MathJax-Span-2267" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.952em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\theta</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\beta</script>.<p></p>
<h2 id="variational-distribution">Variational distribution</h2>
<p>Here we come up with a variational distribution on latent variables, which can be decomposed as:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-120-Frame" style=""><nobr><span class="math" id="MathJax-Span-2668" style="width: 15.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.969em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.582em, 1000em, 3.913em, -0.444em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2669"><span class="mi" id="MathJax-Span-2670" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-2671" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2672" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2673" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2674" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="texatom" id="MathJax-Span-2675"><span class="mrow" id="MathJax-Span-2676"><span class="mo" id="MathJax-Span-2677" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2678" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2679" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2680" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2681" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2682" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2683" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">q</span><span class="mo" id="MathJax-Span-2684" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2685" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2686" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2687" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2688" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2689" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.419em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-2690" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∏</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.45em, -0.459em); top: -1.037em; left: 0.052em;"><span class="texatom" id="MathJax-Span-2691"><span class="mrow" id="MathJax-Span-2692"><span class="mi" id="MathJax-Span-2693" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2694" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2695" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.354em, -0.483em); top: -3.388em; left: 0.417em;"><span class="mi" id="MathJax-Span-2696" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-2697" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-2698" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2699"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.737em, -0.471em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2700" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.417em;"><span class="mi" id="MathJax-Span-2701" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2702"><span class="mrow" id="MathJax-Span-2703"><span class="mo" id="MathJax-Span-2704" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2705"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2706" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.625em;"><span class="mi" id="MathJax-Span-2707" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2708" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.748em; vertical-align: -1.571em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-120">
q(\theta,z|\gamma,\phi)=q(\theta,\gamma)\prod_{n=1}^Nq(z_n|\phi_n)
</script><br>and optimize:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-121-Frame" style=""><nobr><span class="math" id="MathJax-Span-2709" style="width: 23.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.948em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.598em, 1000em, 3.795em, -0.421em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2710"><span class="mo" id="MathJax-Span-2711" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2712"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2713" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.527em;"><span class="mo" id="MathJax-Span-2714" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2715" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2716" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2717" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.625em;"><span class="mo" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2719" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2720" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munder" id="MathJax-Span-2721" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.813em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.432em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2722" style="font-family: STIXGeneral-Regular;">argmin</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.589em, -0.455em); top: -1.294em; left: 0.911em;"><span class="mrow" id="MathJax-Span-2723"><span class="mi" id="MathJax-Span-2724" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span class="mo" id="MathJax-Span-2725" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2726" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2727" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.794em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2728" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.729em;"><span class="texatom" id="MathJax-Span-2729"><span class="mrow" id="MathJax-Span-2730"><span class="texatom" id="MathJax-Span-2731"><span class="mrow" id="MathJax-Span-2732"><span class="mi" id="MathJax-Span-2733" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-2734" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">L</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2735" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2736" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-2737" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2738" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2739" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2740" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="texatom" id="MathJax-Span-2741"><span class="mrow" id="MathJax-Span-2742"><span class="mo" id="MathJax-Span-2743" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2744" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2745" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2746" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2747" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2748" style="font-family: STIXGeneral-Regular;">∥</span><span class="mi" id="MathJax-Span-2749" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2750" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2751" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2752" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2753" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="texatom" id="MathJax-Span-2754"><span class="mrow" id="MathJax-Span-2755"><span class="mo" id="MathJax-Span-2756" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2757" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-2758" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2759" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2760" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2761" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2762" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2763" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.387em; vertical-align: -1.429em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-121">
(\gamma^*,\phi^*)=\underset{\gamma,\phi}{\operatorname{argmin}} 
D_{\mathrm{KL}}(q(\theta,z|\gamma,\phi)\|p(\theta,z|w,\alpha,\beta))
</script><br>to minimize the difference between the variational distribution and the true posterior distribution.<br>Play with the formula above and we will get:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-122-Frame" style=""><nobr><span class="math" id="MathJax-Span-2764" style="width: 28.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.802em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.654em, 1000em, 2.874em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2765"><span class="msubsup" id="MathJax-Span-2766"><span style="display: inline-block; position: relative; width: 1.794em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2767" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.729em;"><span class="texatom" id="MathJax-Span-2768"><span class="mrow" id="MathJax-Span-2769"><span class="texatom" id="MathJax-Span-2770"><span class="mrow" id="MathJax-Span-2771"><span class="mi" id="MathJax-Span-2772" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-2773" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">L</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2774" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2775" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-2776" style="font-family: STIXGeneral-Regular;">∥</span><span class="mi" id="MathJax-Span-2777" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2778" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2779" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-2780" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2781" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2782" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2783" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2784" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2785" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2786" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2787" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2788" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2789" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2790" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2791" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-2792"></span><span class="mi" id="MathJax-Span-2793" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2794" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2795" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-2796"><span class="mrow" id="MathJax-Span-2797"><span class="mo" id="MathJax-Span-2798" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2799" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2800" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2801" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2802" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2803" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mtext" id="MathJax-Span-2804" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">constant for&nbsp;</span><span class="mi" id="MathJax-Span-2805" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2806" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2807" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.215em; vertical-align: -0.324em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-122">
D_{\mathrm{KL}}(q\|p)+L(\gamma,\phi;\alpha,\beta)=\log p(w|\alpha,\beta)=
\text{constant for }\gamma,\phi
</script><br>where<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-123-Frame" style=""><nobr><span class="math" id="MathJax-Span-2808" style="width: 25.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.25em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.954em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2809"><span class="mi" id="MathJax-Span-2810" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2811" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2812" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2813" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2814" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2815" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2816" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2817" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2818" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2819" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2820" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-2821" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2822" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2824"></span><span class="mo" id="MathJax-Span-2825" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2826" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2827"></span><span class="mi" id="MathJax-Span-2828" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2829" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2830" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2831" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2832" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2833" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2834" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="texatom" id="MathJax-Span-2835"><span class="mrow" id="MathJax-Span-2836"><span class="mo" id="MathJax-Span-2837" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2838" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2839" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2840" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2841" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2842" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2843" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-2844" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2845" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-2846" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2847"></span><span class="mo" id="MathJax-Span-2848" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2849" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2850"></span><span class="mi" id="MathJax-Span-2851" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-2852" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2853" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2854" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2855" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2856" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2857" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.42em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-123">
L(\gamma,\phi;\alpha,\beta)=\operatorname E_q[\log p(\theta,z,w|\alpha,\beta)]
-\operatorname E_q[\log q(\theta,z)]
</script><br>So minimizing the KL divergence is equivalent to maximizing the function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-124-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2858" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2859"><span class="mi" id="MathJax-Span-2860" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">L</script> as the lower bound of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-125-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2861" style="width: 6.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.874em, -0.45em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2862"><span class="mi" id="MathJax-Span-2863" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2864"></span><span class="mi" id="MathJax-Span-2865" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2866" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2867" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-2868"><span class="mrow" id="MathJax-Span-2869"><span class="mo" id="MathJax-Span-2870" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2871" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2872" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2873" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2874" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.206em; vertical-align: -0.324em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">\log p(w|\alpha,\beta)</script>:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-126-Frame" style=""><nobr><span class="math" id="MathJax-Span-2875" style="width: 14.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.344em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.598em, 1000em, 3.795em, -0.421em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2876"><span class="mo" id="MathJax-Span-2877" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2878"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2879" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.527em;"><span class="mo" id="MathJax-Span-2880" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2881" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2882" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2883" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.625em;"><span class="mo" id="MathJax-Span-2884" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2885" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2886" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munder" id="MathJax-Span-2887" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.969em; height: 0px;"><span style="position: absolute; clip: rect(1.884em, 1000em, 2.874em, -0.432em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2888" style="font-family: STIXGeneral-Regular;">argmax</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.589em, -0.455em); top: -1.294em; left: 0.99em;"><span class="mrow" id="MathJax-Span-2889"><span class="mi" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span class="mo" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2892" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-2893" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2894" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2895" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2896" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2897" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2898" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2899" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2900" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2902" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.387em; vertical-align: -1.429em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-126">
(\gamma^*,\phi^*)=\underset{\gamma,\phi}{\operatorname{argmax}} L(\gamma,\phi;\alpha,\beta)
</script><p></p>
<h2 id="parameter-estimation">Parameter estimation</h2>
<p>Variational EM algorithm:</p>
<ul>
<li>E-step: maximize the lower bound <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-127-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2903" style="width: 5.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.862em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2904"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2906" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2907" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2908" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2909" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2910" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2911" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2912" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2914" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.192em; vertical-align: -0.31em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">L(\gamma,\phi;\alpha,\beta)</script> with respect to the variational parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-128-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2915" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2916"><span class="mi" id="MathJax-Span-2917" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.31em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">\gamma</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-129-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2918" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2919"><span class="mi" id="MathJax-Span-2920" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.191em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">\phi</script></li><li>M-step: maximize the bound with respect to the model parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2298" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2299"><span class="mi" id="MathJax-Span-2300" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.667em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\alpha</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\beta</script></li></ul>
<h3 id="e-step-variational-inference">E-step: variational inference</h3>
<p>A few more steps:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-130-Frame" style=""><nobr><span class="math" id="MathJax-Span-2921" style="width: 42.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.208em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.463em, 1000em, 3.308em, -0.31em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-2922"><span class="mtable" id="MathJax-Span-2923" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 34.844em; height: 0px;"><span style="position: absolute; clip: rect(2.455em, 1000em, 4.885em, -0.477em); top: -4.01em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.862em, -0.477em); top: -3.217em; right: 0em;"><span class="mtd" id="MathJax-Span-2924"><span class="mrow" id="MathJax-Span-2925"><span class="mi" id="MathJax-Span-2926" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2927" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2928" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2929" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2930" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2931" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2932" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2933" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2934" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2935" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -0.469em); top: -3.292em; right: 0em;"><span class="mtd" id="MathJax-Span-2978"><span class="mrow" id="MathJax-Span-2979"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.455em, 1000em, 5.183em, -0.469em); top: -4.01em; left: 4.688em;"><span style="display: inline-block; position: relative; width: 30.156em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.954em, -0.469em); top: -3.217em; left: 0em;"><span class="mtd" id="MathJax-Span-2936"><span class="mrow" id="MathJax-Span-2937"><span class="texatom" id="MathJax-Span-2938"><span class="mrow" id="MathJax-Span-2939"></span></span><span class="mo" id="MathJax-Span-2940" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2941"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2942" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-2943" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2944"></span><span class="mo" id="MathJax-Span-2945" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2946" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2947"></span><span class="mi" id="MathJax-Span-2948" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2949" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2950" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2951" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2952" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2953" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="texatom" id="MathJax-Span-2955"><span class="mrow" id="MathJax-Span-2956"><span class="mo" id="MathJax-Span-2957" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2958" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2959" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2960" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2961" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2962" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2963" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-2964" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2965" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-2966" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2967"></span><span class="mo" id="MathJax-Span-2968" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2969" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2970"></span><span class="mi" id="MathJax-Span-2971" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-2972" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2973" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2974" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2975" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span><span class="mo" id="MathJax-Span-2976" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2977" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.661em, 1000em, 2.954em, -0.469em); top: -1.781em; left: 0em;"><span class="mtd" id="MathJax-Span-2980"><span class="mrow" id="MathJax-Span-2981"><span class="texatom" id="MathJax-Span-2982"><span class="mrow" id="MathJax-Span-2983"></span></span><span class="mo" id="MathJax-Span-2984" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2985"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-2986" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-2987" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-2988"></span><span class="mo" id="MathJax-Span-2989" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2990" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2991"></span><span class="mi" id="MathJax-Span-2992" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-2993" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2994" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="texatom" id="MathJax-Span-2995"><span class="mrow" id="MathJax-Span-2996"><span class="mo" id="MathJax-Span-2997" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2998" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-2999" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3000" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3001" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3002" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3003" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-3004" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3005"></span><span class="mo" id="MathJax-Span-3006" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3007" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3008" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3009" style="font-family: STIXGeneral-Italic;">z</span><span class="texatom" id="MathJax-Span-3010"><span class="mrow" id="MathJax-Span-3011"><span class="mo" id="MathJax-Span-3012" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-3013" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-3014" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3015" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3016" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3017" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3018" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-3019" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3020"></span><span class="mo" id="MathJax-Span-3021" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3022" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3023" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3024" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-3025"><span class="mrow" id="MathJax-Span-3026"><span class="mo" id="MathJax-Span-3027" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-3028" style="font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-3029" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3030" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-3031" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3032" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3033" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-3034" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3035" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3037"></span><span class="mo" id="MathJax-Span-3038" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3039" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3040"></span><span class="mi" id="MathJax-Span-3041" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-3042" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3043" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-3044" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3045" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3046" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-3047" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.065em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.656em, -0.457em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3048" style="font-family: STIXGeneral-Regular;">E</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.625em;"><span class="mi" id="MathJax-Span-3049" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3050"></span><span class="mo" id="MathJax-Span-3051" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3052" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3053"></span><span class="mi" id="MathJax-Span-3054" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-3055" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3056" style="font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-3057" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3058" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.165em; vertical-align: -1.282em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-130">
\begin{align}
L(\gamma,\phi;\alpha,\beta)
&{}=\operatorname E_q[\log p(\theta,z,w|\alpha,\beta)]-\operatorname E_q[\log q(\theta,z)]\\
&{}=\operatorname E_q[\log p(\theta|\alpha)]+\operatorname E_q[p(z|\theta)]+\operatorname E_q[p(w|z,\beta)]-\operatorname E_q[\log q(\theta)]-\operatorname E_q[\log q(z)]
\end{align}
</script><br>Struggle through <strong>heavy math</strong> to compute each term and we finally get (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-131-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3059" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.677em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.454em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3060"><span class="mi" id="MathJax-Span-3061" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.9em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">\psi</script> is the digamma function):<p></p>
<p></p><div align="center"><br><img src="resources/AF74B1443C3E59CD7B70CF5F26C098120.png"  width="80%" height="80%"><br></div><br>Taking derivatives of this function and set derivatives to zero yields the update formulas.<br>The variational inference algorithm update <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-128-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2915" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2916"><span class="mi" id="MathJax-Span-2917" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.31em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">\gamma</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-129-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2918" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2919"><span class="mi" id="MathJax-Span-2920" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.191em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">\phi</script> alternately until convergence:<p></p>
<p></p><div align="center"><br><img src="resources/6BB7A2D2F8384D1FD2EEE73D757448A2.png" width="55%" height="55%"><br></div><p></p>
<h3 id="m-step">M-step</h3>
<p>Maximize <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-127-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2903" style="width: 5.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.862em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2904"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2906" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2907" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2908" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2909" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2910" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2911" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2912" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2914" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.192em; vertical-align: -0.31em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">L(\gamma,\phi;\alpha,\beta)</script> with respect to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\beta</script>:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-132-Frame" style=""><nobr><span class="math" id="MathJax-Span-3062" style="width: 27.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.865em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.166em, 1000em, 5.771em, -0.477em); top: -4.219em; left: 0em;"><span class="mrow" id="MathJax-Span-3063"><span class="msubsup" id="MathJax-Span-3064"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3065" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.57em;"><span class="mi" id="MathJax-Span-3066" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3067" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3068" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3069" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.453em, -0.458em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3070"><span class="mrow" id="MathJax-Span-3071"><span class="mi" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-3073" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3074" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.481em); top: -3.388em; left: 0.313em;"><span class="mi" id="MathJax-Span-3075" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3076" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3077" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.45em, -0.459em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3078"><span class="mrow" id="MathJax-Span-3079"><span class="mi" id="MathJax-Span-3080" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3081" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3082" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(3.292em, 1000em, 4.279em, -0.483em); top: -5.223em; left: 0.229em;"><span class="texatom" id="MathJax-Span-3083"><span class="mrow" id="MathJax-Span-3084"><span class="msubsup" id="MathJax-Span-3085"><span style="display: inline-block; position: relative; width: 0.844em; height: 0px;"><span style="position: absolute; clip: rect(1.57em, 1000em, 2.354em, -0.483em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-3086" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.478em;"><span class="mi" id="MathJax-Span-3087" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3088" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3089" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.452em, -0.434em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3090"><span class="mrow" id="MathJax-Span-3091"><span class="mi" id="MathJax-Span-3092" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3093" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3094" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3095" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3096" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3097" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3098"><span class="mrow" id="MathJax-Span-3099"><span class="mi" id="MathJax-Span-3100" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3101" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3102" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.356em, -0.415em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3103" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3104" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.69em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3105" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.625em;"><span class="texatom" id="MathJax-Span-3106"><span class="mrow" id="MathJax-Span-3107"><span class="mi" id="MathJax-Span-3108" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3109" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3110" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3111"><span style="display: inline-block; position: relative; width: 1.533em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.674em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3112" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.57em, 1000em, 2.49em, -0.556em); top: -2.678em; left: 0.677em;"><span class="mi" id="MathJax-Span-3113" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.353em, -0.458em); top: -1.869em; left: 0.677em;"><span class="texatom" id="MathJax-Span-3114"><span class="mrow" id="MathJax-Span-3115"><span class="mi" id="MathJax-Span-3116" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3117" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-3118" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3119"></span><span class="msubsup" id="MathJax-Span-3120" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3121" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.513em;"><span class="texatom" id="MathJax-Span-3122"><span class="mrow" id="MathJax-Span-3123"><span class="mi" id="MathJax-Span-3124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3125" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3126" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-3127" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3128" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.452em, -0.434em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3129"><span class="mrow" id="MathJax-Span-3130"><span class="mi" id="MathJax-Span-3131" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3132" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3133" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3135" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.672em, -0.481em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3136" style="font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.469em;"><span class="mi" id="MathJax-Span-3137" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3138" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3139" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3140"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3141" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3142"><span class="mrow" id="MathJax-Span-3143"><span class="mi" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3145" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3146" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.356em, -0.415em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3148" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3149" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.513em;"><span class="texatom" id="MathJax-Span-3150"><span class="mrow" id="MathJax-Span-3151"><span class="mi" id="MathJax-Span-3152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3153" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3154" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-3155" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-3156" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.219em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.076em; vertical-align: -1.738em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-132">
L_\beta=\sum_{d=1}^M\sum_{n=1}^{N_d}\sum_{i=1}^K\sum_{j=1}^V
\phi_{dni}w_{dn}^j\log\beta_{ij}+\sum_{i=1}^K\lambda_i\left(\sum_{j=1}^V\beta_{ij}-1\right)
</script><br>Taking the derivative with respect to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-133-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3157" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.301em, 1000em, 2.678em, -0.509em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-3158"><span class="msubsup" id="MathJax-Span-3159"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3160" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.513em;"><span class="texatom" id="MathJax-Span-3161"><span class="mrow" id="MathJax-Span-3162"><span class="mi" id="MathJax-Span-3163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.527em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">\beta_{ij}</script> and setting it to zero:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-134-Frame" style=""><nobr><span class="math" id="MathJax-Span-3165" style="width: 10.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.542em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.569em, 1000em, 3.915em, -0.509em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3166"><span class="msubsup" id="MathJax-Span-3167"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.861em, -0.509em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3168" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.513em;"><span class="texatom" id="MathJax-Span-3169"><span class="mrow" id="MathJax-Span-3170"><span class="mi" id="MathJax-Span-3171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3172" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3173" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∝</span><span class="munderover" id="MathJax-Span-3174" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3175" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.453em, -0.458em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3176"><span class="mrow" id="MathJax-Span-3177"><span class="mi" id="MathJax-Span-3178" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-3179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3180" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.481em); top: -3.388em; left: 0.313em;"><span class="mi" id="MathJax-Span-3181" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3182" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3183" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.45em, -0.459em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3184"><span class="mrow" id="MathJax-Span-3185"><span class="mi" id="MathJax-Span-3186" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3187" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3188" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(3.292em, 1000em, 4.279em, -0.483em); top: -5.223em; left: 0.229em;"><span class="texatom" id="MathJax-Span-3189"><span class="mrow" id="MathJax-Span-3190"><span class="msubsup" id="MathJax-Span-3191"><span style="display: inline-block; position: relative; width: 0.844em; height: 0px;"><span style="position: absolute; clip: rect(1.57em, 1000em, 2.354em, -0.483em); top: -2.188em; left: 0em;"><span class="mi" id="MathJax-Span-3192" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; top: -2.029em; left: 0.478em;"><span class="mi" id="MathJax-Span-3193" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3194" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.69em; height: 0px;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.861em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3195" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.947em; left: 0.625em;"><span class="texatom" id="MathJax-Span-3196"><span class="mrow" id="MathJax-Span-3197"><span class="mi" id="MathJax-Span-3198" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3199" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3200" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3201"><span style="display: inline-block; position: relative; width: 1.533em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.674em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3202" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.57em, 1000em, 2.49em, -0.556em); top: -2.678em; left: 0.677em;"><span class="mi" id="MathJax-Span-3203" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.353em, -0.458em); top: -1.869em; left: 0.677em;"><span class="texatom" id="MathJax-Span-3204"><span class="mrow" id="MathJax-Span-3205"><span class="mi" id="MathJax-Span-3206" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.765em; vertical-align: -1.574em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-134">
\beta_{ij}\propto\sum_{d=1}^M\sum_{n=1}^{N_d}\phi_{dni}w^j_{dn}
</script><p></p>
<p>Maximize <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-127-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2903" style="width: 5.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.661em, 1000em, 2.862em, -0.477em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2904"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2906" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2907" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-2908" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2909" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span><span class="mo" id="MathJax-Span-2910" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2911" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">α</span><span class="mo" id="MathJax-Span-2912" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-2914" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.192em; vertical-align: -0.31em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">L(\gamma,\phi;\alpha,\beta)</script> with respect to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2298" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2299"><span class="mi" id="MathJax-Span-2300" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.667em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\alpha</script>:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-135-Frame" style=""><nobr><span class="math" id="MathJax-Span-3208" style="width: 38.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.292em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.166em, 1000em, 5.771em, -0.477em); top: -4.219em; left: 0em;"><span class="mrow" id="MathJax-Span-3209"><span class="msubsup" id="MathJax-Span-3210"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3211" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.57em;"><span class="mi" id="MathJax-Span-3212" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3213" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3214" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3215" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.453em, -0.458em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3216"><span class="mrow" id="MathJax-Span-3217"><span class="mi" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-3219" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3220" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.481em); top: -3.388em; left: 0.313em;"><span class="mi" id="MathJax-Span-3221" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3222" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3223" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-3224" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3225"></span><span class="mi" id="MathJax-Span-3226" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">Γ</span><span class="mrow" id="MathJax-Span-3227" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3228" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3229"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3230" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3231"><span class="mrow" id="MathJax-Span-3232"><span class="mi" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3234" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3235" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3236" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3237" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3238" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3239" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3240" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3241" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="munderover" id="MathJax-Span-3242" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3243" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.452em, -0.434em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3244"><span class="mrow" id="MathJax-Span-3245"><span class="mi" id="MathJax-Span-3246" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3248" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3249" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-3250" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3251"></span><span class="mi" id="MathJax-Span-3252" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">Γ</span><span class="mo" id="MathJax-Span-3253" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3254"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3255" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3256" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3257" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3258" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3259" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-3260" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3261" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.452em, -0.434em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3262"><span class="mrow" id="MathJax-Span-3263"><span class="mi" id="MathJax-Span-3264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3265" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3266" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3267" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3268" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3269" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-3270" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3271"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3272" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3274" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-3275" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-3276" style="font-family: STIXGeneral-Regular;">)</span><span class="mrow" id="MathJax-Span-3277" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3278" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-3279" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mo" id="MathJax-Span-3280" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3281"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3282" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.946em; left: 0.441em;"><span class="texatom" id="MathJax-Span-3283"><span class="mrow" id="MathJax-Span-3284"><span class="mi" id="MathJax-Span-3285" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3286" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3287" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3288" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3289" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mrow" id="MathJax-Span-3290" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3291" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3292"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3293" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3294"><span class="mrow" id="MathJax-Span-3295"><span class="mi" id="MathJax-Span-3296" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3297" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3298" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3299" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3300" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3301" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.946em; left: 0.441em;"><span class="texatom" id="MathJax-Span-3302"><span class="mrow" id="MathJax-Span-3303"><span class="mi" id="MathJax-Span-3304" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3305" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3306" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3307" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3308" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.219em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.076em; vertical-align: -1.738em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">
L_\alpha=\sum_{d=1}^M\left(\log\Gamma\left(\sum_{j=1}^K\alpha_j\right)-\sum_{i=1}^K\log\Gamma(\alpha_i)\right)
+\sum_{i=1}^K\left((\alpha_i-1)\left(\psi(\gamma_{di})-\psi\left(\sum_{j=1}^K\gamma_{dj}\right)\right)\right)
</script><br>Taking the derivative with respect to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-136-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3309" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.538em, 1000em, 2.449em, -0.442em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-3310"><span class="msubsup" id="MathJax-Span-3311"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3312" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3313" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.844em; vertical-align: -0.252em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">\alpha_i</script>:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-137-Frame" style=""><nobr><span class="math" id="MathJax-Span-3314" style="width: 28.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.01em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.166em, 1000em, 5.771em, -0.469em); top: -4.219em; left: 0em;"><span class="mrow" id="MathJax-Span-3315"><span class="mfrac" id="MathJax-Span-3316"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.667em, -0.429em); top: -3.177em; left: 50%; margin-left: -0.521em;"><span class="mrow" id="MathJax-Span-3317"><span class="mi" id="MathJax-Span-3318" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-3319" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.676em, 1000em, 2.814em, -0.429em); top: -1.814em; left: 50%; margin-left: -0.677em;"><span class="mrow" id="MathJax-Span-3320"><span class="mi" id="MathJax-Span-3321" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3322"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3323" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3324" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000em, 1.198em, -0.469em); top: -1.262em; left: 0em;"><span style="border-left-width: 1.474em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-3325" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3326" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mrow" id="MathJax-Span-3327" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3328" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-3329" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mrow" id="MathJax-Span-3330" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3331" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3332"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3333" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3334"><span class="mrow" id="MathJax-Span-3335"><span class="mi" id="MathJax-Span-3336" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3337" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3338" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3339" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3340" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3341" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3342" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3343" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3344" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3345" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mo" id="MathJax-Span-3346" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3347"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3348" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3349" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3350" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3351" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3352" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-3353" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3354" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000em, 2.453em, -0.458em); top: -1.038em; left: 0.026em;"><span class="texatom" id="MathJax-Span-3355"><span class="mrow" id="MathJax-Span-3356"><span class="mi" id="MathJax-Span-3357" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mo" id="MathJax-Span-3358" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3359" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.481em); top: -3.388em; left: 0.313em;"><span class="mi" id="MathJax-Span-3360" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3361" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3362" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-3363" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mo" id="MathJax-Span-3364" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3365"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3366" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.946em; left: 0.441em;"><span class="texatom" id="MathJax-Span-3367"><span class="mrow" id="MathJax-Span-3368"><span class="mi" id="MathJax-Span-3369" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3370" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3371" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3372" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3373" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mrow" id="MathJax-Span-3374" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3375" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3376"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3377" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3378"><span class="mrow" id="MathJax-Span-3379"><span class="mi" id="MathJax-Span-3380" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3381" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3382" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3383" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3384" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 2.862em, -0.45em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3385" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -1.946em; left: 0.441em;"><span class="texatom" id="MathJax-Span-3386"><span class="mrow" id="MathJax-Span-3387"><span class="mi" id="MathJax-Span-3388" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-3389" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3390" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3391" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.219em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.076em; vertical-align: -1.738em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-137">
\frac{\partial L}{\partial \alpha_i}=M\left(\psi\left(\sum_{j=1}^K\alpha_j\right)-\psi(\alpha_i)\right)
+\sum_{d=1}^M\left(\psi(\gamma_{di})-\psi\left(\sum_{j=1}^K\gamma_{dj}\right)\right)
</script><br>It is difficult to compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-136-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3309" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.538em, 1000em, 2.449em, -0.442em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-3310"><span class="msubsup" id="MathJax-Span-3311"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3312" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3313" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.844em; vertical-align: -0.252em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">\alpha_i</script> by setting the derivative to zero. So we compute the Hessian Matrix by: (if <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-138-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3392" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.69em, 1000em, 2.863em, -0.42em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3393"><span class="mi" id="MathJax-Span-3394" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3395" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3396" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-138">i=j</script> then <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-139-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3397" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.906em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.668em, 1000em, 2.863em, -0.445em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3398"><span class="mi" id="MathJax-Span-3399" style="font-family: STIXGeneral-Italic;">δ</span><span class="mo" id="MathJax-Span-3400" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3401" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3402" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3403" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3404" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3405" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3406" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">\delta(i,j)=1</script> or 0 otherwise)<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-140-Frame" style=""><nobr><span class="math" id="MathJax-Span-3407" style="width: 20.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.166em, 1000em, 5.771em, -0.469em); top: -4.219em; left: 0em;"><span class="mrow" id="MathJax-Span-3408"><span class="mfrac" id="MathJax-Span-3409"><span style="display: inline-block; position: relative; width: 2.776em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.471em, 1000em, 2.667em, -0.429em); top: -3.177em; left: 50%; margin-left: -0.755em;"><span class="mrow" id="MathJax-Span-3410"><span class="msubsup" id="MathJax-Span-3411"><span style="display: inline-block; position: relative; width: 0.908em; height: 0px;"><span style="position: absolute; clip: rect(1.676em, 1000em, 2.667em, -0.429em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3412" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.582em; left: 0.469em;"><span class="mn" id="MathJax-Span-3413" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-3414" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.676em, 1000em, 2.953em, -0.429em); top: -1.814em; left: 50%; margin-left: -1.328em;"><span class="mrow" id="MathJax-Span-3415"><span class="mi" id="MathJax-Span-3416" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3417"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3418" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3419" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-3420" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3421"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3422" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000em, 1.198em, -0.469em); top: -1.262em; left: 0em;"><span style="border-left-width: 2.776em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-3424" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3425" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mrow" id="MathJax-Span-3426" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3427" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msup" id="MathJax-Span-3428"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3429" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.752em;"><span class="mo" id="MathJax-Span-3430" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3431" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3432" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎛<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎝<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎜<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3433"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3434" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.59em, -0.556em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3435"><span class="mrow" id="MathJax-Span-3436"><span class="mi" id="MathJax-Span-3437" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3438" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3439" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.344em, -0.464em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3440" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3441" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3442" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3444" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3445" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3446" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">δ</span><span class="mo" id="MathJax-Span-3447" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3448" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3449" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3450" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3451" style="font-family: STIXGeneral-Regular;">)</span><span class="msup" id="MathJax-Span-3452"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.454em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3453" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.752em;"><span class="mo" id="MathJax-Span-3454" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3455" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3456"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3457" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.573em;"><span class="mi" id="MathJax-Span-3458" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3459" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3460" style="vertical-align: 1.896em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.31em; left: 0em;">⎞<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.018em; left: 0em;">⎠<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.546em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.782em; left: 0em;">⎟<span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.219em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.076em; vertical-align: -1.738em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">
\frac{\partial^2L}{\partial\alpha_i\partial\alpha_j}=
M\left(\psi'\left(\sum_{j=1}^K\alpha_j\right)
-\delta(i,j)\psi'(\alpha_i)\right)
</script><br>and input this Hessian Matrix and the derivative to <strong>Newton Method</strong> to get <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2298" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-2299"><span class="mi" id="MathJax-Span-2300" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.667em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\alpha</script>. <p></p>
<h2 id="gibbs-sampling">Gibbs Sampling</h2>
<p>(for smoothed version)<br>Theoretical analysis:</p>
<p></p><div align="center"><br><img src="resources/65FB60974C4E05D96972D1B28AF6AFF1.png" width="85%" height="85%"><br></div><br>due to conjugate prior. Note that the normalizer of the first term is omitted, because the sum is the length of each document, which is fixed, while the second denominator might change after each update.<p></p>
<p>Algorithm:</p>
<p></p><div align="center"><br><img src="resources/175AC95E999CE184D4302D7AC68955BE.png" width="60%" height="60%"><br></div><br>Comparisons and discussions for MCMC and Variational Bayes see <a href="Variational Bayes.html">Variational Bayes</a>.<p></p>
<h2 id="extensions">Extensions</h2>
<h3 id="relaxing-the-assumptions-">Relaxing the assumptions:</h3>
<ul>
<li>order of words doesn't matter ("Bag of words" assumption)</li><li>order of documents doesn't matter =&gt; time-evolving, dynamic topic model</li><li>the number of topics is assumed known, fixed and flat =&gt; Bayesian nonparametric topic model</li><li>topics are not correlated =&gt; correlated topic model</li><li>...</li></ul>
<h3 id="incorporating-meta-data-">incorporating meta-data:</h3>
<p>authors, links, other labels(supervised)...</p>
<h3 id="other-problems">other problems</h3>
<p>model checking, visualization, data discovery...</p>
<h2 id="references">References</h2>
<p>Blei, David M. "Probabilistic topic models." Communications of the ACM 55.4 (2012): 77-84.<br>"Machine Learning" Lecture 19: <a href="http://www.umiacs.umd.edu/~jbg/teaching/CSCI_5622/">http://www.umiacs.umd.edu/~jbg/teaching/CSCI_5622/</a><br>"Probabilistic Models for Unsupervised Learning" Lecture 5: <a href="http://home.cse.ust.hk/~lzhang/teach/6931a/">http://home.cse.ust.hk/~lzhang/teach/6931a/</a><br>Dirichlet-Multinomial Distribution: <a href="https://en.wikipedia.org/wiki/Dirichlet-multinomial_distribution#A_combined_example:_LDA_topic_models">https://en.wikipedia.org/wiki/Dirichlet-multinomial_distribution#A_combined_example:_LDA_topic_models</a><br>Darling, William M. "A theoretical and practical implementation tutorial on topic modeling and gibbs sampling." Proceedings of the 49th annual meeting of the association for computational linguistics: Human language technologies. 2011.</p>
</div><div class="cell text-cell"></div></div>
  <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = 'Metropolis-Hastings Algorithm.html';
if (e.keyCode === 37) window.location.href = 'KL Divergence.html';
}</script>
</body>
</html>