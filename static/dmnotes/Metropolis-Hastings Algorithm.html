<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- common.css -->
  <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: Arial, Helvetica, sans-serif;margin: 0;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre {margin: 0;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
  <!-- ace-static.css -->
  <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
  <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
  <!-- export.css -->
  <style>
    body{margin:0 auto;max-width:800px;line-height:1.4}
    #nav{margin:5px 0 10px;font-size:15px}
    #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
    #contentarea{font-size:15px;margin:16px 0}
    .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
    .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
    .latex-cell{white-space:pre-wrap;}
  </style>
  <!-- User CSS -->
  <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
</head>
<body>
  <div id="nav"><div>Next: <a href='Multinomial Distribution.html'>Multinomial Distribution</a>, Previous: <a href='Latent Dirichlet Allocation.html'>Latent Dirichlet Allocation</a>, Up: <a href='index.html'>Index</a></div></div>
  <div id="titlearea">
    <h2>Metropolis-Hastings Algorithm</h2>
  </div>
  <div id="contentarea"><div class="cell markdown-cell"><p>Our target:<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-142-Frame" style=""><nobr><span class="math" id="MathJax-Span-3461" style="width: 13.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.001em, 1000em, 4.582em, -0.477em); top: -3.542em; left: 0em;"><span class="mrow" id="MathJax-Span-3462"><span class="mi" id="MathJax-Span-3463" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-3464" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-3465" style="font-family: STIXIntegralsD; vertical-align: -0.615em; padding-left: 0.313em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.45em;"></span></span><span class="mi" id="MathJax-Span-3466" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">h</span><span class="mo" id="MathJax-Span-3467" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3468" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3469" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-3470" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3471" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3472" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-3474"><span class="mrow" id="MathJax-Span-3475"><span class="mi" id="MathJax-Span-3476" style="font-family: STIXGeneral-Regular;">d</span></span></span><span class="mi" id="MathJax-Span-3477" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3478" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-3479" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.47em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3480" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.654em;"><span class="mi" id="MathJax-Span-3481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3482" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3483" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-3484" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3485" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3486" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3487" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 3.542em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.848em; vertical-align: -1.124em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-142">
I=\int h(x)f(x)\mathrm{d}x=E_f[h(x)]
</script><br>It's hard to compute it directly. Aprroximation:<br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-143-Frame" style=""><nobr><span class="math" id="MathJax-Span-3488" style="width: 7.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.582em, 1000em, 3.914em, -0.744em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3489"><span class="texatom" id="MathJax-Span-3490"><span class="mrow" id="MathJax-Span-3491"><span class="munderover" id="MathJax-Span-3492"><span style="display: inline-block; position: relative; width: 0.422em; height: 0px;"><span style="position: absolute; clip: rect(1.691em, 1000em, 2.656em, -0.477em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3493" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -4.287em; left: 0.111em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3494" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.677em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3495" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-3496" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.849em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.668em, 1000em, 2.656em, -0.358em); top: -3.177em; left: 50%; margin-left: -0.26em;"><span class="mn" id="MathJax-Span-3497" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.691em, 1000em, 2.671em, -0.489em); top: -1.814em; left: 50%; margin-left: -0.365em;"><span class="mi" id="MathJax-Span-3498" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000em, 1.198em, -0.469em); top: -1.262em; left: 0em;"><span style="border-left-width: 0.849em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3499" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(1.733em, 1000em, 3.496em, -0.379em); top: -2.865em; left: 0em;"><span class="mo" id="MathJax-Span-3500" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.865em;"></span></span><span style="position: absolute; clip: rect(1.553em, 1000em, 2.452em, -0.434em); top: -1.038em; left: 0.104em;"><span class="texatom" id="MathJax-Span-3501"><span class="mrow" id="MathJax-Span-3502"><span class="mi" id="MathJax-Span-3503" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3504" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3505" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.47em, 1000em, 2.354em, -0.483em); top: -3.388em; left: 0.391em;"><span class="mi" id="MathJax-Span-3506" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mi" id="MathJax-Span-3507" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">h</span><span class="mo" id="MathJax-Span-3508" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3509"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3510" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mi" id="MathJax-Span-3511" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3512" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.748em; vertical-align: -1.572em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-143">
\hat I=\frac{1}{N}\sum_{i=1}^Nh(x_i)
</script><br>where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-144-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3513" style="width: 4.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.817em, -0.496em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3514"><span class="msubsup" id="MathJax-Span-3515"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3516" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mn" id="MathJax-Span-3517" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3518" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-3519" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-3520" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-3521" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.062em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3522" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mi" id="MathJax-Span-3523" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.255em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-144">x_1,\dots,x_N</script> are sampled from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-145-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3524" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.863em, -0.616em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3525"><span class="mi" id="MathJax-Span-3526" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.187em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">f</script>.<br>In order to sample from f, we generate a Markov chain <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-146-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3527" style="width: 4.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.806em, -0.496em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3528"><span class="msubsup" id="MathJax-Span-3529"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3530" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mn" id="MathJax-Span-3531" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3532" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3533" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3534" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="mn" id="MathJax-Span-3535" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3536" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-3537" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.834em; vertical-align: -0.242em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">x_1,x_2,\dots</script>, whose stationary distribution is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-145-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3524" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.666em, 1000em, 2.863em, -0.616em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3525"><span class="mi" id="MathJax-Span-3526" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.187em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">f</script>, and draw samples from the chain.<br>In order to generate the desired Markov chain, we use the Metropolis-Hastings Algorithm:<p></p>
<p></p><div align="center"><br><img src="resources/65D828DC59AD1AC4A7FAF9CC000E47CD.png" height="400" weight="400"><br></div><br>which ensures the fraction of time spent in each state <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-147-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3538" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3539"><span class="mi" id="MathJax-Span-3540" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.667em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-147">x</script> is proportional to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-148-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3541" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3542"><span class="msubsup" id="MathJax-Span-3543"><span style="display: inline-block; position: relative; width: 1.013em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3544" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.55em; left: 0.521em;"><span class="mo" id="MathJax-Span-3545" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3546" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3547" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3548" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.206em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">p^*(x)</script>.<br><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-149-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3549" style="width: 2.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.621em, 1000em, 2.861em, -0.525em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3550"><span class="texatom" id="MathJax-Span-3551"><span class="mrow" id="MathJax-Span-3552"><span class="munderover" id="MathJax-Span-3553"><span style="display: inline-block; position: relative; width: 0.558em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0.019em;"><span class="mi" id="MathJax-Span-3554" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1000em, 3.569em, -0.471em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-3555" style=""><span style="font-family: STIXSizeOneSym;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3556" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3557" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3558" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.239em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-149">\widetilde p(x)</script> is unnormalized <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-148-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3541" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.648em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3542"><span class="msubsup" id="MathJax-Span-3543"><span style="display: inline-block; position: relative; width: 1.013em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3544" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.55em; left: 0.521em;"><span class="mo" id="MathJax-Span-3545" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3546" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3547" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3548" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.206em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">p^*(x)</script>. <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-150-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3559" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.865em, -0.444em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3560"><span class="mi" id="MathJax-Span-3561" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.905em; vertical-align: -0.313em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">q</script> is called a <strong>kernel</strong> or a <strong>proposal distribution</strong>, which propose a value that can be accepted or reject.<br>Why it works: satisfying detailed balance.<p></p>
<p>In practice it's hard to tell whether the Markov chain has reached its stationary distribution (computationally intractable), though there are a handful of diagnosing tricks. Samples collected before the chain has reached its stationary distribution do not come from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-151-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3562" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.283em, 1000em, 2.497em, -0.544em); top: -2.135em; left: 0em;"><span class="mrow" id="MathJax-Span-3563"><span class="msubsup" id="MathJax-Span-3564"><span style="display: inline-block; position: relative; width: 1.013em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.861em, -0.544em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3565" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.55em; left: 0.521em;"><span class="mo" id="MathJax-Span-3566" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.135em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.206em; vertical-align: -0.308em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-151">p^*</script>, and are usually thrown away. The initial period, whose samples will be ignored, is called the <strong>burn-in phase</strong>.</p>
<p>special case: Gibbs sampling.<br><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-152-Frame" style=""><nobr><span class="math" id="MathJax-Span-3567" style="width: 15.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.604em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.531em, 1000em, 2.962em, -0.444em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3568"><span class="mi" id="MathJax-Span-3569" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3570" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3571"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3572" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.6em; left: 0.52em;"><span class="mo" id="MathJax-Span-3573" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3574"><span class="mrow" id="MathJax-Span-3575"><span class="mo" id="MathJax-Span-3576" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-3577" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3578" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3579" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3580" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-3581" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3582"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3583" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.632em, 1000em, 2.324em, -0.438em); top: -2.512em; left: 0.52em;"><span class="mo" id="MathJax-Span-3584" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.569em, 1000em, 2.352em, -0.434em); top: -1.889em; left: 0.466em;"><span class="mi" id="MathJax-Span-3585" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3586"><span class="mrow" id="MathJax-Span-3587"><span class="mo" id="MathJax-Span-3588" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3589"><span style="display: inline-block; position: relative; width: 1.27em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3590" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="texatom" id="MathJax-Span-3591"><span class="mrow" id="MathJax-Span-3592"><span class="mo" id="MathJax-Span-3593" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3594" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3595" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-3596"><span class="mrow" id="MathJax-Span-3597"><span class="mi" id="MathJax-Span-3598" style="font-family: STIXGeneral-Regular;">I</span><span class="mi" id="MathJax-Span-3599" style="font-family: STIXGeneral-Regular;">I</span></span></span><span class="mo" id="MathJax-Span-3600" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3601"><span style="display: inline-block; position: relative; width: 1.27em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3602" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.632em, 1000em, 2.324em, -0.438em); top: -2.512em; left: 0.52em;"><span class="mo" id="MathJax-Span-3603" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span><span style="position: absolute; clip: rect(1.569em, 1000em, 2.352em, -0.423em); top: -1.889em; left: 0.466em;"><span class="texatom" id="MathJax-Span-3604"><span class="mrow" id="MathJax-Span-3605"><span class="mo" id="MathJax-Span-3606" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3607" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3608" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-3609" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.27em; height: 0px;"><span style="position: absolute; clip: rect(1.903em, 1000em, 2.667em, -0.496em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-3610" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.038em; left: 0.466em;"><span class="texatom" id="MathJax-Span-3611"><span class="mrow" id="MathJax-Span-3612"><span class="mo" id="MathJax-Span-3613" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3614" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span></span><span class="mo" id="MathJax-Span-3615" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.467em; vertical-align: -0.429em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-152">
q(x'|x)=p(x_i'|x_{-i})\mathrm{II}(x'_{-i}=x_{-i})
</script><br>In Gibbs sampling, the acceptance probability <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-153-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3616" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.668em, 1000em, 2.667em, -0.442em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-3617"><span class="mi" id="MathJax-Span-3618" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-3619" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≡</span><span class="mn" id="MathJax-Span-3620" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.949em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">\alpha\equiv1</script>.<p></p>
<h3 id="reference">reference</h3>
<p>Book: Machine Learning - A Probabilistic Perspective(Chapter 24)</p>
</div></div>
  <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = 'Multinomial Distribution.html';
if (e.keyCode === 37) window.location.href = 'Latent Dirichlet Allocation.html';
}</script>
</body>
</html>